---
import { getLangFromPath } from '@/i18n/lang'
import { getCategoryPath } from '@/i18n/path'
import { getAllCategories } from '@/utils/content'

const currentPath = Astro.url.pathname
const currentLang = getLangFromPath(currentPath)
const categories = await getAllCategories(currentLang)

// Extract category from URL if we are on a category page
const isCategoryPage = /\/categories\/[^/]+\//.test(currentPath)
const currentCategory = isCategoryPage ? decodeURIComponent(currentPath.match(/\/categories\/([^/]+)\//)?.[1] || '') : undefined
---

{categories.length > 0 && (
  <div class="mt-4 uno-decorative-line hidden lg:mt-8 lg:block"></div>
  <nav class="mt-4 lg:mt-8">
    <ul class="flex flex-row gap-x-5 overflow-x-auto scrollbar-hidden lg:(flex-col gap-y-2 overflow-x-visible)">
      {categories.map(category => (
        <li>
          <a
            href={getCategoryPath(category, currentLang)}
            class:list={[
              'block whitespace-nowrap font-navbar text-3.5 transition-colors hover:c-primary lg:text-3.8',
              currentCategory === category ? 'font-medium c-primary' : 'c-secondary',
            ]}
          >
            <strong>{category}</strong>
          </a>
        </li>
      ))}
    </ul>
  </nav>
)}
